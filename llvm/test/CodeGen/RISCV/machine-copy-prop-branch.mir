# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
# RUN: llc -mtriple=riscv32 %s -run-pass=machine-cp -o - -debug
# RUN: llc -mtriple=riscv32 %s -run-pass=machine-cp -o - | FileCheck %s
# RUN: llc -mtriple=riscv32 %s -start-before=machine-cp -o - | FileCheck %s --check-prefix=ASM
## Check that the zero constant register is not spilled to the stack here.
--- |
  define i32 @foo(i32 %a, i32 %b) nounwind {
  ; ASM-LABEL: foo:
  ; ASM:       # %bb.0:
  ; ASM-NEXT:    addi sp, sp, -16
  ; ASM-NEXT:    sw s2, 12(sp) # 4-byte Folded Spill
  ; ASM-NEXT:    sw s4, 8(sp) # 4-byte Folded Spill
  ; ASM-NEXT:    li s2, 0
  ; ASM-NEXT:    mv s4, a1
  ; ASM-NEXT:    bltz a0, .LBB0_2
  ; ASM-NEXT:  # %bb.1:
  ; ASM-NEXT:    mv a0, s4
  ; ASM-NEXT:  .LBB0_2:
  ; ASM-NEXT:    mv a1, s2
  ; ASM-NEXT:    lw s2, 12(sp) # 4-byte Folded Reload
  ; ASM-NEXT:    lw s4, 8(sp) # 4-byte Folded Reload
  ; ASM-NEXT:    addi sp, sp, 16
  ; ASM-NEXT:    ret
    ret i32 0
  }
...
---
name: foo
body: |
  ; CHECK-LABEL: name: foo
  ; CHECK: bb.0:
  ; CHECK-NEXT:   successors: %bb.2(0x40000000), %bb.1(0x40000000)
  ; CHECK-NEXT:   liveins: $x10, $x11
  ; CHECK-NEXT: {{  $}}
  ; CHECK-NEXT:   renamable $x18 = COPY $x0
  ; CHECK-NEXT:   BLT killed renamable $x10, $x0, %bb.2
  ; CHECK-NEXT: {{  $}}
  ; CHECK-NEXT: bb.1:
  ; CHECK-NEXT:   successors: %bb.2(0x80000000)
  ; CHECK-NEXT: {{  $}}
  ; CHECK-NEXT:   $x10 = COPY $x11
  ; CHECK-NEXT:   BLT renamable $x18, killed renamable $x11, %bb.2
  ; CHECK-NEXT: {{  $}}
  ; CHECK-NEXT: bb.2:
  ; CHECK-NEXT:   $x11 = COPY killed renamable $x18
  ; CHECK-NEXT:   PseudoRET implicit $x10, implicit $x11
  bb.0:
    liveins: $x10, $x11
    renamable $x18 = COPY $x0
    BLT killed renamable $x10, $x0, %bb.2

  bb.1:
    $x10 = COPY $x11
    BLT renamable $x18, killed renamable $x11, %bb.2

  bb.2:
    $x11 = COPY killed renamable $x18
    PseudoRET implicit $x10, implicit $x11
